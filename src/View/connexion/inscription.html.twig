{% extends 'layout.html.twig' %}
{% block title %}Inscription
	{{ parent() }}
{% endblock %}
{% block content %}
	<body>
		<header>
			<div class="header">
				<div class="header__logo">
					<?xml version="1.0" encoding="UTF-8"?>
					<svg id="Calque_1" data-name="Calque 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 248 248">
					<defs>
						<style>
						svg {
							width:20%;
						}
						.cls-1 {
							fill: #fefffe;
						}

						.cls-1, .cls-2 {
							stroke-width: 0px;
						}

						.cls-2 {
							fill: #101a31;
						}
						</style>
					</defs>
					<circle class="cls-2" cx="124" cy="124" r="124"/>
					<path class="cls-1" d="m96,46h21.68l-10.84,58.78s-5.84,22.22,14.16,23.22c0,0,19,3,26-15l10-46h-24s6.37-21,22.18-21h27.64l-11.83,62s-4,22-34,47l-46-10s-7-17-7-23c0,0-3-20,12-76Z"/>
					<polygon class="cls-1" points="93 156 104 187 128 164 93 156"/>
					<path class="cls-1" d="m111,202s6,31,30,10c0,0,42-45,59-50,0,0,22-8,39,12l-3,6s-21-23-44-6c0,0-25,21-31,29,0,0-25,32-46,23,0,0-13-4-12-23,0,0,3-7,8-1Z"/>
					</svg>
					<a href="/"><h1>Loufok</h1></a>
				</div>
				<p>Créez, inspirez, délirez</p>
			</div>
		</header>
		<section class="section">
            <h2 class="section__h2"> Inscription </h2>
			<form class="section__form" action="/inscription" method="POST">
                    <label for="nomPlume">Votre nom de plume</label>
                    <input placeholder="Marcel Pagnol" type="text" name="nomPlume" id="nomPlumeInput" required>

					<!-- Ajoutez un élément pour afficher le message d'erreur -->
					<div id="errorMessage" style="color: red;"></div>

                    <label for="email">Votre adresse e-mail</label>
                    <input placeholder="adressemail@gmail.com" type="email" name="email" required>

					<label for="sexe">Sexe</label>
					<div id="sexe">
						<input type="radio" name="sexe" id="homme" value="homme">
						<label for="homme">Homme</label>

						<input type="radio" name="sexe" id="femme" value="femme">
						<label for "femme">Femme</label>

						<input type="radio" name="sexe" id="ne-se-prononce-pas" value="Null">
						<label for="ne-se-prononce-pas">Se prononce pas</label>
					</div>

                    <label for="ddn">Date de naissance</label>
                    <input type="date" name="ddn" required>

                    <label for="motDePasse">Votre mot de passe</label>
                    <input type="password" name="motDePasse" required>

				<button type="submit" class="button__disabled" id="btnValider">Créer un compte</button>
			</form>
		</section>
		<div class="hidden">
			{% for allplume in allplumes %}	
				<p class="plumes">{{ allplume.nom_plume }}</p>
			{% endfor %}
		</div>
	</body>
	{% block scripts %}
	<script>
		const form = document.querySelector('.section__form');
		const btnValider = document.getElementById('btnValider');
		const nomPlumeInput = document.getElementById('nomPlumeInput');
		const errorMessage = document.getElementById('errorMessage');
		const plumes = document.querySelectorAll('.plumes');

		    function checkNomPlume() {
        const enteredNomPlume = nomPlumeInput.value.trim();
        const plumeExists = Array.from(plumes).some(plume => plume.textContent === enteredNomPlume);

        if (plumeExists) {
            errorMessage.textContent = "Le nom de plume existe déjà.";
            errorMessage.style.display = "block";

            btnValider.classList.remove('button__validate');
            btnValider.classList.add('button__disabled');
            btnValider.disabled = true;
        } else {
            errorMessage.style.display = "none";
            checkForm();
        }
    }

    function checkForm() {
        let isFormValid = true;
        const inputs = form.querySelectorAll('input');

        inputs.forEach(input => {
            if (input.type !== 'radio' && input.value.trim() === '') {
                isFormValid = false;
            }
        });

        const select = form.querySelector('select');
        if (select && select.value === '') {
            isFormValid = false;
        }

        if (isFormValid) {
            btnValider.classList.remove('button__disabled');
            btnValider.classList.add('button__validate');
            btnValider.removeAttribute('disabled');
        } else {
            btnValider.classList.remove('button__validate');
            btnValider.classList.add('button__disabled');
            btnValider.disabled = true;
        }
    }

    const inputs = form.querySelectorAll('input');
    inputs.forEach(input => {
        input.addEventListener('input', checkNomPlume);
    });

    const select = form.querySelector('select');
    if (select) {
        select.addEventListener('input', checkForm);
    }

    checkForm();
	</script>
	{% endblock %}
{% endblock %}
